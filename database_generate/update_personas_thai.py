"""
Script to update persona fields to Thai language in the database
"""

import sqlite3
import os
import sys

# Fix encoding for Windows console
if sys.platform == 'win32':
    import io
    sys.stdout = io.TextIOWrapper(sys.stdout.buffer, encoding='utf-8', errors='replace')
    sys.stderr = io.TextIOWrapper(sys.stderr.buffer, encoding='utf-8', errors='replace')

# Database path
DB_PATH = os.path.join(os.path.dirname(__file__), 'interview_data.db')

def update_personas_to_thai():
    """Update all persona fields to Thai language"""
    
    conn = sqlite3.connect(DB_PATH)
    cursor = conn.cursor()
    
    print("Updating personas to Thai language...")
    
    # List of all updates
    updates = [
        # P1
        ("P1", "พนักงานออฟฟิศหญิง", "คอนโด", "ทำอาหารเป็นบางครั้ง", "ชอบกลิ่นหอมและล้างออกง่าย", ""),
        
        # P2
        ("P2", "แม่บ้าน/แม่เลี้ยงเด็กเต็มเวลา", "มีลูกวัย 2 ขวบ", "อยู่บ้าน ทำอาหารทุกวัน", "ความปลอดภัยของผลิตภัณฑ์, ฉลาก 'อ่อนโยน', ไม่มีสารเคมีตกค้าง", ""),
        
        # P3
        ("P3", "พ่อทำงาน/พนักงานบริษัทเอกชน", "มีลูก 1 คน", "ล้างจานหลังอาหารเย็นทุกวัน", "ซื้อแบบขายส่ง (แม็คโคร), เน้นความเข้มข้นและความคุ้มค่า", ""),
        
        # P4
        ("P4", "นักศึกษามหาวิทยาลัย", "หอพักกับเพื่อนอีก 1 คน", "ทำอาหารง่ายๆ", "ซื้อที่ 7-11 เพื่อความสะดวกหรือ Shopee สำหรับซื้อจำนวนมาก/ราคา; กลิ่นดี, ขวดปั๊ม (ประหยัดพื้นที่), ราคาเหมาะกับนักศึกษา", ""),
        
        # P5
        ("P5", "พนักงานออฟฟิศสายครีเอทีฟ", "กรุงเทพ", "มินิมัลลิสต์, ชีวิตแบบยั่งยืน; ทำอาหารง่ายๆ, ล้างจานทุกวัน", "ให้ความสำคัญกับส่วนผสมที่เป็นมิตรกับสิ่งแวดล้อม (ไม่มี SLS/Paraben) และบรรจุภัณฑ์รีไซเคิลได้", ""),
        
        # P6
        ("P6", "เจ้าของร้านอาหารตามสั่ง", "ธุรกิจขนาดเล็กมีพนักงาน 2 คน", "ใช้งานหนัก (ล้างจานหลายสิบชุดต่อวัน)", "ราคาต่อหน่วย, ความเข้มข้น, พลังขจัดคราบมัน; ซื้อขายส่ง (แกลลอน/กล่อง)", ""),
        
        # P7
        ("P7", "แม่บ้านโรงแรม", "ครัวพนักงานและล้างจาน", "หลายครั้งต่อวัน", "ความเงางาม, ไม่มีคราบมันตกค้าง (โดยเฉพาะแก้วไวน์), ความเร็ว", ""),
        
        # P8
        ("P8", "แม่เกษียณ", "ต่างจังหวัด", "ทำอาหารทุกวัน", "กลิ่นหอม (สดชื่น/สะอาด), ความอ่อนโยน (มือผู้สูงอายุ), ความคุ้นเคย/ความไว้วางใจ", ""),
        
        # P9
        ("P9", "พนักงานสายครีเอทีฟ/มินิมัลลิสต์", "คอนโด (อยู่คนเดียว)", "สายครีเอทีฟ, ทำอาหารง่ายๆ, ล้างทุกมื้อ", "ดีไซน์ (บรรจุภัณฑ์), กลิ่นหอม (สะอาด/ธรรมชาติ), ฟังก์ชัน (ฟองน้อย)", ""),
        
        # P10
        ("P10", "พ่อครอบครัว/พนักงานออฟฟิศ", "แต่งงาน, มีลูกสาว 2 คน", "ทำอาหารเย็น, ล้างจานกับลูกๆ", "การสร้างความผูกพันในครอบครัว, บรรยากาศที่ดี (กลิ่นหอม), ความปลอดภัยสำหรับเด็ก", ""),
        
        # P11
        ("P11", "แรงงานรับจ้างทั่วไป (ต่างจังหวัด)", "ภรรยาขายอาหาร (ผัดไทย) หน้าบ้าน", "หนัก (ล้างหลังร้านปิด)", "ความคุ้มค่า (แกลลอน/ขายส่ง), โปรโมชั่น, การขจัดคราบมัน", ""),
        
        # P12
        ("P12", "เจ้าของ SME (บริษัทดีไซน์)", "พนักงาน 15 คน; ครัวออฟฟิศ (แก้วกาแฟ, อาหารกลางวัน)", "", "ความสะอาด, ภาพลักษณ์มืออาชีพ, กลิ่นหอม (ไม่ติดทน), ขวดปั๊ม", ""),
        
        # P13
        ("P13", "คอนเทนต์ครีเอเตอร์/อินฟลูเอนเซอร์", "บ้านมินิมัลและไลฟ์สไตล์", "Sunlight (ธรรมชาติ/มะนาว) หรือแบรนด์ญี่ปุ่น", "บรรจุภัณฑ์สวยงาม (โทนขาว/เหลือง), แนวคิดธรรมชาติ/ยั่งยืน", ""),
        
        # P14
        ("P14", "นักศึกษาต่างชาติ (ออสเตรเลีย)", "หอพักร่วมกับเพื่อนต่างชาติ 4 คน", "ซื้อ/ใช้ร่วมกัน", "กลิ่นสากล (มะนาว), ขวดขนาดกลาง, ล้างออกง่าย (เนื่องจากแรงดันน้ำ)", ""),
        
        # P15
        ("P15", "พนักงานออฟฟิศ/ผู้มีผิวแพ้ง่าย", "", "ทำอาหารเย็นทุกวัน", "ส่วนผสมอ่อนโยน (อโลเวร่า, วิตามินอี), ไม่มี SLS/แอลกอฮอล์", "โรคผิวหนังอักเสบจากการสัมผัส (แพ้สารเคมีรุนแรง)"),
        
        # P16
        ("P16", "แม่ใหม่ (ลาคลอด)", "มีลูกวัย 6 เดือน", "ล้างขวดนมและจานหลายครั้งต่อวัน", "เกรดอาหาร, ปลอดภัยสำหรับเด็ก, ไม่มีสารเคมีตกค้าง, ผ่านการทดสอบโดยแพทย์ผิวหนัง", ""),
        
        # P17
        ("P17", "แม่บ้านคอนโดให้เช่ารายวัน", "", "ทำความสะอาดห้องและล้างจานหลังแขก; 20-30 ชุดในวันที่มีแขกเยอะ", "ความเร็ว, ความคุ้มค่า (ขนาดแกลลอน), การขจัดคราบมัน", ""),
        
        # P18
        ("P18", "แม่ค้าตลาด (หมูปิ้ง)", "", "เริ่มตี 4, ล้างอุปกรณ์คราบมันหนักหลังขาย", "ขจัดคราบมันหนัก, ความคุ้มค่าแบบขายส่ง, ฟองน้อย (เพื่อประหยัดน้ำ)", "แรงดันน้ำจำกัดที่ตลาด, เร่งเวลา"),
        
        # P19
        ("P19", "มืออาชีพในอุตสาหกรรมแฟชั่น", "คอนโดหรู (ทองหล่อ)", "ทำอาหารเล็กน้อย", "ความสวยงามระดับพรีเมียม, กลิ่นหอมหรูหรา (ซิตรัส/สมุนไพร), ดีไซน์มินิมัล", ""),
        
        # P20
        ("P20", "ครูโรงเรียนประจำ", "หอพักโรงเรียน/โรงอาหาร", "ล้างถาด/จานนักเรียน", "ความปลอดภัยสำหรับเด็ก (ไม่มีตกค้าง), ความอ่อนโยน (สำหรับพนักงาน/ตัวเอง), ความคุ้มค่า", ""),
        
        # P21
        ("P21", "ไรเดอร์ส่งอาหาร", "", "ล้างอุปกรณ์ส่งอาหารและของส่วนตัวทุกคืน", "ความเร็ว, กลิ่นสดชื่น (มะนาว/เบอร์กามอต) เพื่อการผ่อนคลาย, ความสะดวก", "ภาชนะมันๆ, ความเหนื่อยล้า"),
        
        # P22
        ("P22", "นักศึกษามหาวิทยาลัย", "หอพักในเมือง", "", "กลิ่นผ่อนคลาย/สดชื่น (ลาเวนเดอร์/ชาเขียว), ขนาดกะทัดรัด, ฟองน้อย", "อ่างล้างจานเล็ก/พื้นที่จำกัด"),
        
        # P23
        ("P23", "ผู้สูงอายุอยู่คนเดียว", "", "", "ขวดบีบง่าย, พื้นผิวไม่ลื่น, กลิ่นอ่อน, ความปลอดภัย/ความไว้วางใจ", "โรคข้ออักเสบ, มือแห้ง"),
        
        # P24
        ("P24", "เจ้าของคาเฟ่/เชฟ", "คาเฟ่เล็กที่มีครัวเปิด", "ใช้งานสูงทุกวัน", "การขจัดคราบมัน, ไม่มีกลิ่นตกค้าง (ส่งผลต่อกลิ่นกาแฟ), ภาพลักษณ์ร้าน (บรรจุภัณฑ์)", ""),
        
        # P25
        ("P25", "นักวิจัยห้องแล็บ/นักเคมี", "อุปกรณ์ห้องแล็บและกล่องอาหารกลางวันส่วนตัว", "อุตสาหกรรม (ห้องแล็บ) / Sunlight (บ้าน)", "ไม่มีสารเคมีตกค้างเลย, ไม่มีกลิ่น/กลิ่นสะอาด, ล้างออกง่าย", ""),
    ]
    
    # Execute updates
    for interview_id, role, environment, usage_pattern, key_drivers, constraints in updates:
        cursor.execute("""
            UPDATE personas 
            SET role = ?, 
                environment = ?, 
                usage_pattern = ?, 
                key_drivers = ?, 
                constraints = ?
            WHERE interview_id = ?
        """, (role, environment, usage_pattern, key_drivers, constraints, interview_id))
        print(f"Updated {interview_id}: {role}")
    
    conn.commit()
    
    # Verify updates
    print("\n" + "="*80)
    print("Verification - First 5 records:")
    print("="*80)
    cursor.execute("""
        SELECT interview_id, role, key_drivers 
        FROM personas 
        ORDER BY interview_id 
        LIMIT 5
    """)
    
    for row in cursor.fetchall():
        print(f"{row[0]}: {row[1]}")
        print(f"   Key Drivers: {row[2][:80]}...")
        print()
    
    conn.close()
    print("All personas updated to Thai language successfully!")
    print(f"Database: {DB_PATH}")

if __name__ == "__main__":
    update_personas_to_thai()
